# 🚀 실행 컨텍스트 🚀

- 실행할 코드에 관한 환경 정보들을 모아놓은 객체
- JS는 실행컨텍스트를 콜스택에 쌓아올린 후 실행하여 코드의 환경과 순서를 보장 할 수 있게 된다.

![IMG_0097](https://gamguma.dev/_next/image?url=%2F2022%2F04%2Fjs_execution_context%2Fimages%2Fcontext_example.png&w=1920&q=75)

- 처음 JS코드를 실행하는 순간 (1)처럼 전역 컨텍스트가 콜스택에 담긴다.
- 브라우저의 경우 `window`, node 환경의 경우 `global` 같은 객체를 사용할 수 있는 이유

1. 콜스택엔 전역 컨텍스트를 제외하곤 다른 컨텍스트가 없기에 전역 컨텍스트와 관련된 코드를 진행합니다.
2. 전역 컨텍스트와 관련된 코드를 진행 중 a함수를 실행하였기에 a 함수의 환경 정보들을 수집하여 a 실행 컨텍스트를 생성, 콜스택에 담습니다.<br>
   콜스택 최상단에 a 실행 컨텍스트가 있기에 기존의 전역 컨텍스트와 관련된 코드의 실행을 일시적으로 중단한 후 a 실행 컨텍스트의 코드를 실행합니다.
3. a 함수 내부에서 b 함수를 실행하였기에 b 함수의 환경 정보들을 수집, 실행 컨텍스트를 생성, 콜스택에 담습니다. <br>
   이전과 똑같이 콜스택 최상단에 b 실행 컨텍스트가 있기에 기존 a 실행 컨텍스트와 관련된 코드의 실행을 일시적 중단합니다.
4. b 함수가 종료된 후 b 실행 컨텍스트가 콜스택에서 제거됩니다. 제거 후 콜스택 최상단에는 a 실행 컨텍스트가 있기에 이전에 중단된 지점부터 코드 진행이 재개됩니다.
5. a 함수 또한 종료된 후 실행 컨텍스트가 콜스택에서 제거됩니다.
6. 이후엔 전역 공간에 실행할 코드가 남아있지 않다면 콜스택에서 전역 컨텍스트 또한 제거되며 콜스택에 아무 것도 남지 않은 상태로 종료됩니다.

   <br>

# 실행 컨텍스트 속엔 어떤 정보가 있을까?

### Variabel Environment

- Variabel Environment란 현재 컨텍스트 내부의 식별자 정보 `environmentRecord`, 외부 환경정보 `outerEnvironmentReference`가 포함되어 있다.
- VariableEnvironment 에 먼저 정보를 담고, 그대로 LexicalEnvironment 에 복사해 사용한다고 합니다.

### LexicalEnvironment

- VariableEnvironment 초기 상태를 기억하고 있으며, LexicalEnvironment 최신 상태를 저장하고 있습니다.

### environmentRecord

- environmentRecord 란 현재 컨텍스트와 관련된 식별자와 식별자에 바인딩된 값이 기록되는 공간입니다.
  더불어 실행 컨텍스트 내부 전체를 처음부터 끝까지 확인하며 순서대로 수집합니다.

# 실행 컨텍스트가 활성화 되는 시점

- 호이스팅이 발생한다.(선언된 변수를 위로 끌어올린다.)
- 외부 환경 정보를 구성한다.
- this값을 설정한다

<br>

```javascript
var a = 1; // 전역 컨텍스트
function outer() {
  // outer 컨텍스트
  function inner() {
    // inner 컨텍스트
    console.log(a); // undefined
    var a = 3;
    console.log(a); // 3
  }
  inner();
  console.log(a); // 1
}
outer();
console.log(a); // 1
```

- 위와 같이 코드를 구성했을 때 실행 컨텍스트의 스택은 다음과 같은 순서로 실행된다.
  1. 프로그램 실행: [전역컨텍스트]
  2. outer 실행: [전역컨텍스트, outer]
  3. inner 실행: [전역컨텍스트, outer, inner]
  4. inner 종료: [전역컨텍스트, outer]
  5. outer 종료: [전역컨텍스트]

### 실행 컨텍스트가 구성되는 코드들은 다음과 같다

- 전역 코드
- eval 코드
- 함수 코드
- 모듈 코드

<br>

## 1. 구조

- JS엔진은 실행 컨텍스트의 추상화된 정보들을 물리적 개체 형태로 관리

=== 추가 내용 ===
